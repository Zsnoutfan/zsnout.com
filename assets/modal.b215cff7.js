import{o as p,a as g,r as A,d as R,f as _,q,s as U,c as F,g as m,n as j,u as f,j as k,w as E,L as J,e as I,t as P,z as Q,F as W,T as X,M as Y,N as O}from"./vendor.bc10800d.js";import{_ as L,b as Z,c as B}from"./index.46aeed2e.js";const ee={},le={class:"button"};function ne(n,r){return p(),g("button",le,[A(n.$slots,"default",{},void 0,!0)])}var z=L(ee,[["render",ne],["__scopeId","data-v-f49bc62c"]]);const te=["placeholder","value"],ae=R({props:{placeholder:null,value:null},setup(n){let r=_(null);function l(o){var a,c;if(o.key=="/"){if(o.stopImmediatePropagation(),document.activeElement==r.value)return(a=r.value)==null?void 0:a.focus();(c=r.value)==null||c.focus(),o.preventDefault()}}return q(()=>{var o;document.addEventListener("keydown",l),(o=r.value)==null||o.focus()}),U(()=>document.removeEventListener("keydown",l)),(o,a)=>(p(),g("input",{ref_key:"fieldEl",ref:r,class:"field",placeholder:n.placeholder,value:n.value,type:"text"},null,8,te))}});var ue=L(ae,[["__scopeId","data-v-b901424c"]]);const re={class:"modal-outer"},oe={class:"modal-inner"},ce={class:"text"},ie=R({props:{buttons:null,placeholder:null,fieldValue:null},emits:["cancel","select","submit"],setup(n,{emit:r}){var K;const{buttons:l}=n;let o=(l==null?void 0:l.filter(e=>e.value!="cancel"))||[],a=l==null?void 0:l.find(e=>e.submitter),c=_(!1),y=_(!1),i=_(!1),d=null,s=null,h=_(null),x=_(null),G=(K=l==null?void 0:l.find(e=>e.value==="cancel"))==null?void 0:K.content,v=!0;q(()=>{var w,b,$,N;a||((w=document.activeElement)==null||w.blur(),($=(b=h.value)==null?void 0:b.children[0])==null||$.focus()),window.addEventListener("keydown",S);let e=(N=h.value)==null?void 0:N.children,t=(e==null?void 0:e[0])||null,u=(e==null?void 0:e[(e==null?void 0:e.length)-1])||null;d=t,s=u,t==null||t.addEventListener("keydown",D),u==null||u.addEventListener("keydown",M),setTimeout(()=>{c.value=!0,setTimeout(()=>v=!1,500)})}),U(()=>{window.removeEventListener("keydown",S),d==null||d.removeEventListener("keydown",D),s==null||s.removeEventListener("keydown",M)});function D(e){e.key=="Tab"&&e.shiftKey&&(e.preventDefault(),s==null||s.focus())}function M(e){e.key=="Tab"&&!e.shiftKey&&(e.preventDefault(),d==null||d.focus())}function S(e){if(e.key=="Escape"&&C(),e.key=="Tab"){if(!h.value)return;[...h.value.children].includes(document.activeElement)||(e.preventDefault(),e.shiftKey?s==null||s.focus():d==null||d.focus())}}function T(){return y.value=!0,setTimeout(()=>c.value=!1),new Promise(e=>setTimeout(()=>{e(),i.value=!0},500))}async function C(){v||(v=!0,await T(),r("cancel"))}async function H(e){v||(v=!0,await T(),r("select",e))}async function V(e){if(e.preventDefault(),!x.value)return;let t=x.value.children[0];if(!t||!t.value||v)return;let u=t.value;typeof(a==null?void 0:a.submitter)=="function"&&!a.submitter(u)||(v=!0,await T(),r("submit",u))}return(e,t)=>(p(),F(X,{to:"#app"},[m("div",{class:j({background:!0,visible:f(c),hiding:f(y),begone:f(i)})},null,2),m("div",{class:j({container:!0,visible:f(c),hiding:f(y),begone:f(i)}),onClick:t[2]||(t[2]=u=>C())},[k(B,{"keep-height":"","keep-width":""},{default:E(()=>[k(Z,{"explicit-height":""},{default:E(()=>[m("div",re,[m("div",{class:"modal",onClick:t[1]||(t[1]=u=>u.stopPropagation())},[m("div",oe,[m("div",ce,[A(e.$slots,"default",{},void 0,!0)]),f(a)?(p(),g("form",{key:0,ref_key:"fieldEl",ref:x,class:"field",onSubmit:V},[k(ue,{placeholder:n.placeholder,value:n.fieldValue},null,8,["placeholder","value"])],544)):J("",!0),m("div",{ref_key:"buttonEl",ref:h,class:"buttons"},[k(z,{class:"cancel",onClick:t[0]||(t[0]=u=>C())},{default:E(()=>[I(P(f(G)||"Cancel"),1)]),_:1}),(p(!0),g(W,null,Q(f(o),(u,w)=>(p(),F(z,{key:w,onClick:b=>u.submitter?V(b):H(u.value)},{default:E(()=>[I(P(u.content),1)]),_:2},1032,["onClick"]))),128))],512)])])])]),_:3})]),_:3})],2)]))}});var de=L(ie,[["__scopeId","data-v-2b581c0a"]]);function se(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!Y(n)}function fe(n,r,l){return new Promise(o=>{let a=document.createElement("div");document.body.append(a);function c(i){i=="cancel"?o(null):o(i),O(null,a),a.remove()}let y=k(de,{buttons:r,placeholder:l==null?void 0:l.placeholder,fieldValue:l==null?void 0:l.fieldValue,onCancel:()=>c(null),onSelect:i=>c(i),onSubmit:i=>c({value:i})},se(n)?n:{default:()=>[n]});O(y,a)})}async function _e(n,r={}){await fe(n,[{content:r.buttonText||"OK",value:"cancel"}])}export{_e as a};
