import{o as _,a as E,r as A,d as R,f as p,q,s as U,c as F,g as m,n as j,u as f,j as h,w as g,L as H,e as I,t as P,z as J,F as Q,T as X,M as Y,N as O}from"./vendor.c311a53b.js";import{_ as L,b as Z,c as B}from"./index.817c44c4.js";function pe(l,n){document.cookie=`${l}=${n}; path=/`}function _e(l){let t=document.cookie.split(";").find(i=>i.trim().startsWith(`${l}=`));return t?t.split("=")[1]:void 0}const ee={},le={class:"button"};function te(l,n){return _(),E("button",le,[A(l.$slots,"default",{},void 0,!0)])}var z=L(ee,[["render",te],["__scopeId","data-v-f49bc62c"]]);const ne=["placeholder","value"],ae=R({props:{placeholder:null,value:null},setup(l){let n=p(null);function t(i){var o,c;if(i.key=="/"){if(i.stopImmediatePropagation(),document.activeElement==n.value)return(o=n.value)==null?void 0:o.focus();(c=n.value)==null||c.focus(),i.preventDefault()}}return q(()=>{var i;document.addEventListener("keydown",t),(i=n.value)==null||i.focus()}),U(()=>document.removeEventListener("keydown",t)),(i,o)=>(_(),E("input",{ref_key:"fieldEl",ref:n,class:"field",placeholder:l.placeholder,value:l.value,type:"text"},null,8,ne))}});var oe=L(ae,[["__scopeId","data-v-b901424c"]]);const ue={class:"modal-outer"},ie={class:"modal-inner"},ce={class:"text"},re=R({props:{buttons:null,placeholder:null,fieldValue:null},emits:["cancel","select","submit"],setup(l,{emit:n}){var V;const{buttons:t}=l;let i=(t==null?void 0:t.filter(e=>e.value!="cancel"))||[],o=t==null?void 0:t.find(e=>e.submitter),c=p(!1),y=p(!1),r=p(!1),s=null,d=null,k=p(null),C=p(null),W=(V=t==null?void 0:t.find(e=>e.value==="cancel"))==null?void 0:V.content,v=!0;q(()=>{var w,b,K,N;o||((w=document.activeElement)==null||w.blur(),(K=(b=k.value)==null?void 0:b.children[0])==null||K.focus()),window.addEventListener("keydown",M);let e=(N=k.value)==null?void 0:N.children,a=(e==null?void 0:e[0])||null,u=(e==null?void 0:e[(e==null?void 0:e.length)-1])||null;s=a,d=u,a==null||a.addEventListener("keydown",$),u==null||u.addEventListener("keydown",D),setTimeout(()=>{c.value=!0,setTimeout(()=>v=!1,500)})}),U(()=>{window.removeEventListener("keydown",M),s==null||s.removeEventListener("keydown",$),d==null||d.removeEventListener("keydown",D)});function $(e){e.key=="Tab"&&e.shiftKey&&(e.preventDefault(),d==null||d.focus())}function D(e){e.key=="Tab"&&!e.shiftKey&&(e.preventDefault(),s==null||s.focus())}function M(e){if(e.key=="Escape"&&T(),e.key=="Tab"){if(!k.value)return;[...k.value.children].includes(document.activeElement)||(e.preventDefault(),e.shiftKey?d==null||d.focus():s==null||s.focus())}}function x(){return y.value=!0,setTimeout(()=>c.value=!1),new Promise(e=>setTimeout(()=>{e(),r.value=!0},500))}async function T(){v||(v=!0,await x(),n("cancel"))}async function G(e){v||(v=!0,await x(),n("select",e))}async function S(e){if(e.preventDefault(),!C.value)return;let a=C.value.children[0];if(!a||!a.value||v)return;let u=a.value;typeof(o==null?void 0:o.submitter)=="function"&&!o.submitter(u)||(v=!0,await x(),n("submit",u))}return(e,a)=>(_(),F(X,{to:"#app"},[m("div",{class:j({background:!0,visible:f(c),hiding:f(y),begone:f(r)})},null,2),m("div",{class:j({container:!0,visible:f(c),hiding:f(y),begone:f(r)}),onClick:a[2]||(a[2]=u=>T())},[h(B,{"keep-height":"","keep-width":""},{default:g(()=>[h(Z,{"explicit-height":""},{default:g(()=>[m("div",ue,[m("div",{class:"modal",onClick:a[1]||(a[1]=u=>u.stopPropagation())},[m("div",ie,[m("div",ce,[A(e.$slots,"default",{},void 0,!0)]),f(o)?(_(),E("form",{key:0,ref_key:"fieldEl",ref:C,class:"field",onSubmit:S},[h(oe,{placeholder:l.placeholder,value:l.fieldValue},null,8,["placeholder","value"])],544)):H("",!0),m("div",{ref_key:"buttonEl",ref:k,class:"buttons"},[h(z,{class:"cancel",onClick:a[0]||(a[0]=u=>T())},{default:g(()=>[I(P(f(W)||"Cancel"),1)]),_:1}),(_(!0),E(Q,null,J(f(i),(u,w)=>(_(),F(z,{key:w,onClick:b=>u.submitter?S(b):G(u.value)},{default:g(()=>[I(P(u.content),1)]),_:2},1032,["onClick"]))),128))],512)])])])]),_:3})]),_:3})],2)]))}});var se=L(re,[["__scopeId","data-v-2b581c0a"]]);function de(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!Y(l)}function fe(l,n,t){return new Promise(i=>{let o=document.createElement("div");document.body.append(o);function c(r){r=="cancel"?i(null):i(r),O(null,o),o.remove()}let y=h(se,{buttons:n,placeholder:t==null?void 0:t.placeholder,fieldValue:t==null?void 0:t.fieldValue,onCancel:()=>c(null),onSelect:r=>c(r),onSubmit:r=>c({value:r})},de(l)?l:{default:()=>[l]});O(y,o)})}async function ye(l,n={}){await fe(l,[{content:n.buttonText||"OK",value:"cancel"}])}export{ye as a,_e as g,pe as s};
