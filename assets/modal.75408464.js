import{_ as L,o as y,f as g,h as z,d as R,e as _,l as U,x as q,c as N,a as m,n as j,u as f,j as k,w as E,y as J,z as Q,b as I,t as P,g as W,F as X,A as Y,B as Z,C as B,E as A}from"./index.b5946be6.js";const ee={},le={class:"button"};function ne(n,r){return y(),g("button",le,[z(n.$slots,"default",{},void 0,!0)])}var O=L(ee,[["render",ne],["__scopeId","data-v-f49bc62c"]]);const te=["placeholder","value"],ae=R({props:{placeholder:null,value:null},setup(n){let r=_(null);function l(c){var a,o;if(c.key=="/"){if(c.stopImmediatePropagation(),document.activeElement==r.value)return(a=r.value)==null?void 0:a.focus();(o=r.value)==null||o.focus(),c.preventDefault()}}return U(()=>{var c;document.addEventListener("keydown",l),(c=r.value)==null||c.focus()}),q(()=>document.removeEventListener("keydown",l)),(c,a)=>(y(),g("input",{ref_key:"fieldEl",ref:r,class:"field",placeholder:n.placeholder,value:n.value,type:"text"},null,8,te))}});var ue=L(ae,[["__scopeId","data-v-b901424c"]]);const re={class:"modal-outer"},ce={class:"modal-inner"},oe={class:"text"},ie=R({props:{buttons:null,placeholder:null,fieldValue:null},emits:["cancel","select","submit"],setup(n,{emit:r}){var M;const{buttons:l}=n;let c=(l==null?void 0:l.filter(e=>e.value!="cancel"))||[],a=l==null?void 0:l.find(e=>e.submitter),o=_(!1),p=_(!1),i=_(!1),d=null,s=null,h=_(null),x=_(null),G=(M=l==null?void 0:l.find(e=>e.value==="cancel"))==null?void 0:M.content,v=!0;U(()=>{var w,b,$,F;a||((w=document.activeElement)==null||w.blur(),($=(b=h.value)==null?void 0:b.children[0])==null||$.focus()),window.addEventListener("keydown",V);let e=(F=h.value)==null?void 0:F.children,t=(e==null?void 0:e[0])||null,u=(e==null?void 0:e[(e==null?void 0:e.length)-1])||null;d=t,s=u,t==null||t.addEventListener("keydown",D),u==null||u.addEventListener("keydown",S),setTimeout(()=>{o.value=!0,setTimeout(()=>v=!1,500)})}),q(()=>{window.removeEventListener("keydown",V),d==null||d.removeEventListener("keydown",D),s==null||s.removeEventListener("keydown",S)});function D(e){e.key=="Tab"&&e.shiftKey&&(e.preventDefault(),s==null||s.focus())}function S(e){e.key=="Tab"&&!e.shiftKey&&(e.preventDefault(),d==null||d.focus())}function V(e){if(e.key=="Escape"&&T(),e.key=="Tab"){if(!h.value)return;[...h.value.children].includes(document.activeElement)||(e.preventDefault(),e.shiftKey?s==null||s.focus():d==null||d.focus())}}function C(){return p.value=!0,setTimeout(()=>o.value=!1),new Promise(e=>setTimeout(()=>{e(),i.value=!0},500))}async function T(){v||(v=!0,await C(),r("cancel"))}async function H(e){v||(v=!0,await C(),r("select",e))}async function K(e){if(e.preventDefault(),!x.value)return;let t=x.value.children[0];if(!t||!t.value||v)return;let u=t.value;typeof(a==null?void 0:a.submitter)=="function"&&!a.submitter(u)||(v=!0,await C(),r("submit",u))}return(e,t)=>(y(),N(Z,{to:"#app"},[m("div",{class:j({background:!0,visible:f(o),hiding:f(p),begone:f(i)})},null,2),m("div",{class:j({container:!0,visible:f(o),hiding:f(p),begone:f(i)}),onClick:t[2]||(t[2]=u=>T())},[k(Y,{"keep-height":"","keep-width":""},{default:E(()=>[k(J,{"explicit-height":""},{default:E(()=>[m("div",re,[m("div",{class:"modal",onClick:t[1]||(t[1]=u=>u.stopPropagation())},[m("div",ce,[m("div",oe,[z(e.$slots,"default",{},void 0,!0)]),f(a)?(y(),g("form",{key:0,ref_key:"fieldEl",ref:x,class:"field",onSubmit:K},[k(ue,{placeholder:n.placeholder,value:n.fieldValue},null,8,["placeholder","value"])],544)):Q("",!0),m("div",{ref_key:"buttonEl",ref:h,class:"buttons"},[k(O,{class:"cancel",onClick:t[0]||(t[0]=u=>T())},{default:E(()=>[I(P(f(G)||"Cancel"),1)]),_:1}),(y(!0),g(X,null,W(f(c),(u,w)=>(y(),N(O,{key:w,onClick:b=>u.submitter?K(b):H(u.value)},{default:E(()=>[I(P(u.content),1)]),_:2},1032,["onClick"]))),128))],512)])])])]),_:3})]),_:3})],2)]))}});var de=L(ie,[["__scopeId","data-v-2b581c0a"]]);function se(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!B(n)}function fe(n,r,l){return new Promise(c=>{let a=document.createElement("div");document.body.append(a);function o(i){i=="cancel"?c(null):c(i),A(null,a),a.remove()}let p=k(de,{buttons:r,placeholder:l==null?void 0:l.placeholder,fieldValue:l==null?void 0:l.fieldValue,onCancel:()=>o(null),onSelect:i=>o(i),onSubmit:i=>o({value:i})},se(n)?n:{default:()=>[n]});A(p,a)})}async function me(n,r={}){await fe(n,[{content:r.buttonText||"OK",value:"cancel"}])}export{me as a};
