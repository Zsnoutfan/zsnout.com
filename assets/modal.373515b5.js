import{o as _,a as E,r as R,d as q,f as p,m as z,q as U,c as N,g as m,n as I,u as f,i as h,w as g,K as H,e as P,t as j,y as J,F as Q,T as X,L as Y,M as O}from"./vendor.8108f6cd.js";import{_ as L,b as Z,c as B}from"./index.79d2d8ae.js";function pe(l,n){document.cookie=`${l}=${n}; path=/`}function _e(l){let t=document.cookie.split(";").find(i=>i.trim().startsWith(`${l}=`));return t?t.split("=")[1]:void 0}const ee={},le={class:"button"};function te(l,n){return _(),E("button",le,[R(l.$slots,"default",{},void 0,!0)])}var A=L(ee,[["render",te],["__scopeId","data-v-f49bc62c"]]);const ne=["placeholder","value"],ae=q({props:{placeholder:null,value:null},setup(l){let n=p(null);function t(i){var o,c;if(i.key=="/"){if(i.stopImmediatePropagation(),document.activeElement==n.value)return(o=n.value)==null?void 0:o.focus();(c=n.value)==null||c.focus(),i.preventDefault()}}return z(()=>{var i;document.addEventListener("keydown",t),(i=n.value)==null||i.focus()}),U(()=>document.removeEventListener("keydown",t)),(i,o)=>(_(),E("input",{ref_key:"fieldEl",ref:n,class:"field",placeholder:l.placeholder,value:l.value,type:"text"},null,8,ne))}});var oe=L(ae,[["__scopeId","data-v-b901424c"]]);const ue={class:"modal-outer"},ie={class:"modal-inner"},ce={class:"text"},re=q({props:{buttons:null,placeholder:null,fieldValue:null},emits:["cancel","select","submit"],setup(l,{emit:n}){var S;const{buttons:t}=l;let i=(t==null?void 0:t.filter(e=>e.value!="cancel"))||[],o=t==null?void 0:t.find(e=>e.submitter),c=p(!1),y=p(!1),r=p(!1),d=null,s=null,k=p(null),C=p(null),W=(S=t==null?void 0:t.find(e=>e.value==="cancel"))==null?void 0:S.content,v=!0;z(()=>{var w,b,V,F;o||((w=document.activeElement)==null||w.blur(),(V=(b=k.value)==null?void 0:b.children[0])==null||V.focus()),window.addEventListener("keydown",K);let e=(F=k.value)==null?void 0:F.children,a=(e==null?void 0:e[0])||null,u=(e==null?void 0:e[(e==null?void 0:e.length)-1])||null;d=a,s=u,a==null||a.addEventListener("keydown",$),u==null||u.addEventListener("keydown",D),setTimeout(()=>{c.value=!0,setTimeout(()=>v=!1,500)})}),U(()=>{window.removeEventListener("keydown",K),d==null||d.removeEventListener("keydown",$),s==null||s.removeEventListener("keydown",D)});function $(e){e.key=="Tab"&&e.shiftKey&&(e.preventDefault(),s==null||s.focus())}function D(e){e.key=="Tab"&&!e.shiftKey&&(e.preventDefault(),d==null||d.focus())}function K(e){if(e.key=="Escape"&&T(),e.key=="Tab"){if(!k.value)return;[...k.value.children].includes(document.activeElement)||(e.preventDefault(),e.shiftKey?s==null||s.focus():d==null||d.focus())}}function x(){return y.value=!0,setTimeout(()=>c.value=!1),new Promise(e=>setTimeout(()=>{e(),r.value=!0},500))}async function T(){v||(v=!0,await x(),n("cancel"))}async function G(e){v||(v=!0,await x(),n("select",e))}async function M(e){if(e.preventDefault(),!C.value)return;let a=C.value.children[0];if(!a||!a.value||v)return;let u=a.value;typeof(o==null?void 0:o.submitter)=="function"&&!o.submitter(u)||(v=!0,await x(),n("submit",u))}return(e,a)=>(_(),N(X,{to:"#app"},[m("div",{class:I({background:!0,visible:f(c),hiding:f(y),begone:f(r)})},null,2),m("div",{class:I({container:!0,visible:f(c),hiding:f(y),begone:f(r)}),onClick:a[2]||(a[2]=u=>T())},[h(B,{"keep-height":"","keep-width":""},{default:g(()=>[h(Z,{"explicit-height":""},{default:g(()=>[m("div",ue,[m("div",{class:"modal",onClick:a[1]||(a[1]=u=>u.stopPropagation())},[m("div",ie,[m("div",ce,[R(e.$slots,"default",{},void 0,!0)]),f(o)?(_(),E("form",{key:0,ref_key:"fieldEl",ref:C,class:"field",onSubmit:M},[h(oe,{placeholder:l.placeholder,value:l.fieldValue},null,8,["placeholder","value"])],544)):H("",!0),m("div",{ref_key:"buttonEl",ref:k,class:"buttons"},[h(A,{class:"cancel",onClick:a[0]||(a[0]=u=>T())},{default:g(()=>[P(j(f(W)||"Cancel"),1)]),_:1}),(_(!0),E(Q,null,J(f(i),(u,w)=>(_(),N(A,{key:w,onClick:b=>u.submitter?M(b):G(u.value)},{default:g(()=>[P(j(u.content),1)]),_:2},1032,["onClick"]))),128))],512)])])])]),_:3})]),_:3})],2)]))}});var de=L(re,[["__scopeId","data-v-2b581c0a"]]);function se(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!Y(l)}function fe(l,n,t){return new Promise(i=>{let o=document.createElement("div");document.body.append(o);function c(r){r=="cancel"?i(null):i(r),O(null,o),o.remove()}let y=h(de,{buttons:n,placeholder:t==null?void 0:t.placeholder,fieldValue:t==null?void 0:t.fieldValue,onCancel:()=>c(null),onSelect:r=>c(r),onSubmit:r=>c({value:r})},se(l)?l:{default:()=>[l]});O(y,o)})}async function ye(l,n={}){await fe(l,[{content:n.buttonText||"OK",value:"cancel"}])}export{ye as a,_e as g,pe as s};
